<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script src="./MyPromise.js"></script>
    <script>
        //executor 同步执行
        var oP = new MyPromise((res, rej) => {
            // res(0);
            // rej(0);
            // throw new Error('cxj');
            // 异步操作
            // setTimeout(() => {
            //     res(0);
            // }, 2000);

            // console.log(0);
            res(1);
        });
        //链式调用
        // oP.then((val) => {
        //     console.log(val, 'ok');
        //     return 1;
        // }, (reason) => {
        //     console.log(reason, 'no');
        //     return 2;
        // }).then((val) => {
        //     console.log(val, 'ok2');
        // }, (reason) => {
        //     console.log(reason, 'no2');
        // });

        //异步执行
        //抛出错误 throw new Error()
        //空then
        // oP.then((val) => {
        //     console.log(val, 'ok');
        //     throw new Error('cxj');
        //     // return 1;
        // }, (reason) => {
        //     console.log(reason, 'no');
        // }).then().then((val) => {
        //     console.log(val, '空then');
        // }, (reason) => {
        //     console.log(reason, '空then');
        // });
        // console.log(2);

        //返回Promise对象
        // oP.then((val) => {
        //     console.log(val, 'ok');
        //     return new MyPromise((res, rej) => {
        //         rej(0);
        //     })
        // }, (reason) => {
        //     console.log(reason, 'no');
        // }).then((val) => {
        //     console.log(val, 'ok2');
        // }, (reason) => {
        //     console.log(reason, 'no2');
        // });

        function test(delay, x) {
            return new MyPromise((res, rej) => {
                setTimeout(function () {
                    res(x);
                }, delay);
            });
        }

        // MyPromise.race([test(200, 'a'), test(300, 'b'), test(100, 'c')]).then((val) => {
        //     console.log(val, 'ok');
        // }, (reason) => {
        //     console.log(reason, 'no');
        // });

        MyPromise.all([test(200, 'a'), test(300, 'b'), test(100, 'c')]).then((val) => {
            console.log(val, 'ok');
        }, (reason) => {
            console.log(reason, 'no');
        });
    </script>
</body>

</html>